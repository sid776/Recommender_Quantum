@router.get("/dq/summary", response=List[Dict[str, Union[str, int, float]]])
def dq_summary(request, report_date: Optional[date] = None, limit: int = 500):
    with DBConnection() as db:
        if report_date:
            query = f"""
                SELECT * FROM {VW_SUMMARY}
                WHERE coalesce(
                        to_date(CAST(report_date AS STRING)),
                        to_date(CAST(report_date AS STRING), 'yyyyMMdd'),
                        to_date(CAST(report_date AS STRING), 'MMddyyyy'),
                        to_date(CAST(report_date AS STRING), 'ddMMyyyy')
                      ) = to_date('{report_date}')
                LIMIT {int(limit)}
            """
        else:
            query = f"""
                SELECT * FROM {VW_SUMMARY}
                ORDER BY report_date DESC
                LIMIT {int(limit)}
            """
        df = db.execute(query, df=True)
        return df.to_dict(orient="records")
